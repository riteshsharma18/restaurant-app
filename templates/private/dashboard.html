<!DOCTYPE html>
<html lang="en">
<head>
  {%include 'links.html'%}
    <title>Home - Restaurant Application</title>
    <style>
        .image-holder
        {
            width:120px;
            height:120px;
            overflow:hidden;
            display:flex;
            background:var(--primary);
            align-items:center;
            justify-content:center;
        }
        .image-holder img
        {
            width:100px;
            height:100px;
            display:block;
        }

        .holder{
            display:flex;
             align-items:center;
            justify-content:center;
            flex-direction:column;
            cursor:pointer;
        }

        .holder h6
        {
            font-weight:bold;
        }

    </style>
</head>
<body>

    <div class="d-flex" id="wrapper">

        {% include 'private/content/sidebar.html' %}
    
        <!-- Page Content -->
        <div id="page-content-wrapper">
    
          {% include 'private/content/navbar.html' %}
    
          <div class="container-fluid">
            <h1 class="mt-4">Create An Order</h1>
            <p>You can create an order here. Please start adding the products in the Tray</p>

             {%for category in data['categories']%}
               <div class="row">
                  <div class="col-md-12 p-3">
                    <h2 style="display:inline; border-bottom:2px solid black;">{{category.category}}</h2>
                      <div class="row mt-5">
                          {%for product in data.products[category.id]%}

                           <div class="col-1 col-md-3 col-lg-2 holder" onclick="openAddToCartModal('{{product.id}}','{{product.category}}', '{{product.restaurant}}');">
                              <div class="image-holder">

                                    <img src="{{url_for('static', filename='images/'+product.image)}}">
                                    <br/>
                                    <br/>


                              </div>
                                 <h6>{{product.name}}</h6>
                                ${{product.price}}
                          </div>
                          {%endfor%}
                      </div>
                  </div>
              </div>
              {%endfor%}
        </div>
        </div>
        <!-- /#page-content-wrapper -->
    
      </div>
      <!-- /#wrapper -->
   <!-- ADD NEW PRODUCT MODAL STARTS -->


      <div class="modal fade" id="addProductToTrayModal" tabindex="-1" role="dialog" aria-labelledby="addProductModalTitle" aria-hidden="true">

        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header bg-primary">
              <h5 class="modal-title text-white" id="exampleModalLongTitle">Add To Tray  </h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true" class="text-white">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <p>Select Variant</p>
                <div id="elements"></div>
              <p>Quantity</p>
                <div class="text-center" id="num" style="font-size:72px">
                    0
                </div>

                <hr/>
                <div class="row">
                    <div class="col-6">
                        <button type="button"class="btn btn-block btn-secondary"  style="height:100px; font-size:32px; font-weight:bold;" onclick="decrement();" >-</button>
                    </div>  <div class="col-6">
                        <button type="button"class="btn btn-block btn-secondary"  style="height:100px; font-size:32px; font-weight:bold;" onclick="increment()" >+</button>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary btn-block">Add To Tray</button>
            </div>
          </div>
        </div>


      </div>

      <script>
        $("#menu-toggle").click(function(e) {
          e.preventDefault();
          $("#wrapper").toggleClass("toggled");
        });

        var number = 0;

        increment = ()=>{
            number++;
           $("#num").html(number);
        }


        decrement = ()=>{

            if(number>0)
            {
            number--;
               $("#num").html(number);

            }

        }

         renderVariants = (variants) => {
            $("#elements").html("");

            variants.forEach((variant)=>{
                                var element = `
                <input type="radio" name='selectedVariant' id="${variant}" value=${variant} /> ${variant} <br/>

                `;

                $("#elements").append(element);})



        }
        openAddToCartModal = (product, category, restaurant) => {
        number = 0;

            allProducts = {{data.products|safe}};
            products = allProducts[category]
            console.log( );
            variants = products.filter( (pro) => { console.log(pro); return pro['id'] == product })[0]['variants'];
            renderVariants(variants);
           $("#addProductToTrayModal").modal('show');
           $("#num").html(number);
        }




        addToTray = ()=>{



        }


      </script>
    
</body>
</html>